import*as Storage from"@storage";import*as Env from"@env";window.storage=Storage.open(Env.path("USER_DOCUMENTS")+"/data.db");var root=storage.root||initDb(storage);function initDb(e){return e.root={version:1,meta:{},localStorage:{},sessionStorage:{},cookie:{}},e.commit(),e.root}window.localStorage={setItem:function(e,t){root.localStorage[e]=t,storage.commit()},getItem:function(e){return root.localStorage[e]},removeItem:function(e){this.setItem(e,void 0)}},window.sessionStorage={setItem:function(e,t){root.sessionStorage[e]=t},getItem:function(e){return root.sessionStorage[e]},removeItem:function(e){this.setItem(e,void 0)}},String.prototype.toBoolean=function(){return!!/^\s*(true|1|on|yes)\s*$/i.test(this)||!/^\s*(false|0|off|no)\s*$/i.test(this)&&Boolean(this)},Object.defineProperty(document,"cookie",{get:function(){var e=new Map([[".",""],["",""],["none",""],["None",""],["undefined",""],["Undefined",""],["null",""],["Null",""],[void 0,""],[null,""]]),t=location.host,o=location.pathname;if(e.has(t))t="localhost";var i=t.split("."),r=o.split("/");i=u(i),r=u(r);location.host||r.shift();for(var n="",a=".",s=0,f={},l=i.length,c=l-1;c>-1;c--){if(++s<=1)var g=1;if(1==l)g=0;var v=i[c].replace(/\s*/g,"");if(v){n=v+n;if(g||p(n),s==l)a="";n=a+n,g=0}}function p(e){for(var t=storage.root.cookie[e],o=t,i=r.length,n=0;n<=i&&(n!=i||!n);n++){if(n==i&&!n)var a=1;if(!o)break;for(var s in t=o)if(t[s].key){var l=new Date>t[s].expires.getTime();l&&delete t[s],l||(f[t[s].key]=t[s].value)}a||(o=t["@"+r[n]])}}function u(e){for(var t=0;t<e.length;t++){if(o=e[t])var o=o.replace(/\s*/g,"");o||e.splice(t,1),o||t--}return e}var m="",h="; ",d=(s=0,Object.keys(f).length);for(var c in f){if(++s==d)h="";m+=c+"="+f[c]+h}return m},set:function(e){for(var t=new Map([[".",""],["",""],["none",""],["None",""],["undefined",""],["Undefined",""],["null",""],["Null",""],[void 0,""],[null,""]]),o=e.split(";"),i=["key","value"],r=0,n={},a=0;a<o.length;a++){if(r<=1)var s=1;if((h=o[a].trim())||r++,h){var f=h.split("=");s&&(f[1]=f[r]),s&&(f[0]=i[r]),"expires"==f[0]&&(f[1]=new Date(f[1])),"secure"==f[0]&&(f[1]=f[1].toBoolean()),n[f[0]]=f[1];s=0;r<=0&&a--,r++}}if(!n.expires)var l=new Date;if(!n.expires)var c=l.getDate()+7;if(!n.expires)var g=new Date;n.expires||g.setDate(c),n.expires||(n.expires=g),t.has(n.domain)&&(n.domain="localhost");var v=n.domain.split("."),p="",u=".",m=(r=0,storage.root.cookie);for(a=(v=x(v)).length-1;a>-1;a--){if(++r<=1)s=1;var h=v[a].replace(/\s*/g,"");if(1==v.length)s=0;if(h){p=h+p;if(s||m[p]||(m[p]={}),r==v.length)u="";p=u+p,s=0}}t.has(n.path)&&(n.path="/");var d=n.path.split("/"),w="";for(r=0,m=m[p],d=x(d),a=0;a<d.length;a++){r++,(h=d[a].trim())&&(m[h]||(m["@"+h]={}),m=m["@"+h],w+="/"+h)}function x(e){for(var t=0;t<e.length;t++){if(o=e[t])var o=o.replace(/\s*/g,"");o||e.splice(t,1),o||t--}return e}w||(w="/"),n.domain=p,n.path=w,m[n.key]=n,storage.commit()}}),window.Cookies={set:function(e,t,o){if(!o)o={};o.expires||(o.expires=7);var i=new Date;i.setTime(i.getTime()+24*o.expires*60*60*1e3);var r=i.toUTCString(),n=e+"="+t+"; ";for(var a in o)"expires"!=a&&(o[a]=o[a].toString()),"expires"==a&&(o[a]=r),n+=a+"="+o[a]+"; ";document.cookie=n},get:function(e){for(var t=e+"=",o=document.cookie.split(";"),i=0;i<o.length;i++){var r=o[i].trim();if(0==r.indexOf(t))return r.substring(t.length,r.length)}return""},remove:function(e,t){if(!t)t={};t.expires=0,this.set(e,"",t)}};